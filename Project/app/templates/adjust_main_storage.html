<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Adjust Main Storage</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            // Fetch main storage quantity
            function getMainStorageQuantity() {
                $.get('/get_main_storage_quantity', function(data) {
                    $('#main-storage-quantity').text('Main Storage Quantity: ' + data.quantity);
                }).fail(function(response) {
                    alert('Failed to fetch main storage quantity. ' + response.responseText);
                });
            }

            // Fetch entities by type
            function getEntitiesByType(entityType) {
                $.get('/get_entities_by_type', {type: entityType}, function(data) {
                    var $list = $('#entity-list').empty();
                    data.forEach(function(entity) {
                        $list.append($('<li>').text(entity.name + ' - Quantity: ' + entity.quantity));
                    });
                }).fail(function(response) {
                    alert('Failed to fetch entities. ' + response.responseText);
                });
            }

            // Adjust main storage quantity
            $('#adjust-main-storage-form').submit(function(event) {
                event.preventDefault();
                var formData = $(this).serialize();
                $.post('/adjust_main_storage', formData, function(response) {
                    alert(response.message);
                    getMainStorageQuantity();
                }).fail(function(response) {
                    alert('Error: ' + response.responseText);
                });
            });

            // Button click handlers
            $('#show-storages').click(function() {
                getEntitiesByType('storage');
            });
            $('#show-partners').click(function() {
                getEntitiesByType('partner');
            });

            // Initial call to populate main storage quantity
            getMainStorageQuantity();
        });

     
    
 </script>
 
 <script>
    $(document).ready(function() {
  $('#adjust-storage-btn').click(function() {
    var partnerName = $('partner').val();
    var quantity = parseInt($('#quantity').val(), 10);

    // Validate input
    if (!partnerName) {
      alert('Please select a partner.');
      return;
    }

    if (isNaN(quantity) || quantity <= 0) {
      alert('Please enter a valid quantity.');
      return;
    }

    // Create AJAX request
    $.ajax({
      url: '/adjust_main_storage', // The route you have for adjusting storage
      type: 'POST',
      contentType: 'application/json',
      dataType: 'json',
      data: JSON.stringify({
        partner_name: partnerName,
        quantity: quantity
      }),
      success: function(response) {
        // Handle success, update the UI with the new main storage total
        alert('Storage adjusted successfully! New Main Storage Quantity: ' + response.new_quantity);
        // Optionally, you can update the main storage displayed in the UI here
      },
      error: function(xhr) {
        // Handle error
        alert('Error: ' + xhr.responseJSON.error);
      }
    });
  });
});
   </script>



 </head>
 <body>
    <h1>Adjust Main Storage</h1>
    <div id="main-storage-quantity"></div>
    <button id="show-storages">Show Small Storages</button>
    <button id="show-partners">Show Partners</button>
    <div id="entity-container">
        <h2>Entities List</h2>
        <ul id="entity-list"></ul>
    </div>
    <select id="partner-select">
  <!-- Assuming you fill this with options of partner names when the page loads -->
  <!-- Example Option: -->
  <option value="Partner One">Partner One</option>
  <option value="Partner Two">Partner Two</option>
  </select>
  <input type="number" id="quantity" placeholder="Quantity" />
  <button id="adjust-storage-btn">Adjust Storage</button>

    
    
 </body>
 </html>

 


