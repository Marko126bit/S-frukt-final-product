<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Adjust Main Storage</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            // Fetch main storage quantity
            function getMainStorageQuantity() {
                $.get('/get_main_storage_quantity', function(data) {
                    $('#main-storage-quantity').text('Main Storage Quantity: ' + data.quantity);
                }).fail(function(response) {
                    alert('Failed to fetch main storage quantity. ' + response.responseText);
                });
            }

            // Fetch entities by type
            function getEntitiesByType(entityType) {
                $.get('/get_entities_by_type', {type: entityType}, function(data) {
                    var $list = $('#entity-list').empty();
                    data.forEach(function(entity) {
                        $list.append($('<li>').text(entity.name + ' - Quantity: ' + entity.quantity));
                    });
                }).fail(function(response) {
                    alert('Failed to fetch entities. ' + response.responseText);
                });
            }

            // Adjust main storage quantity
            $('#adjust-main-storage-form').submit(function(event) {
                event.preventDefault();
                var formData = $(this).serialize();
                $.post('/adjust_main_storage', formData, function(response) {
                    alert(response.message);
                    getMainStorageQuantity();
                }).fail(function(response) {
                    alert('Error: ' + response.responseText);
                });
            });

            // Button click handlers
            $('#show-storages').click(function() {
                getEntitiesByType('storage');
            });
            $('#show-partners').click(function() {
                getEntitiesByType('partner');
            });

            // Initial call to populate main storage quantity
            getMainStorageQuantity();
        });

        $.ajax({
    url: '/adjust_main_storage', // The URL to your adjust_main_storage route
    type: 'POST',
    data: {
        partner_id: partnerId,
        quantity: quantity
    },
    success: function(response) {
        // Handle success - update the UI with the new quantity
        $('#main-storage-quantity-display').text('Main Storage Quantity: ' + response.new_quantity);
        alert('Main storage quantity adjusted successfully!');
    },
    error: function(xhr) {
        // Handle error - alert the user
        var errorMsg = xhr.responseJSON && xhr.responseJSON.error ? xhr.responseJSON.error : xhr.statusText;
        alert('Error adjusting main storage: ' + errorMsg);
    }
  });
   
 
    
 </script>
</head>
<body>
    <h1>Adjust Main Storage</h1>
    <div id="main-storage-quantity"></div>
    <button id="show-storages">Show Small Storages</button>
    <button id="show-partners">Show Partners</button>
    <div id="entity-container">
        <h2>Entities List</h2>
        <ul id="entity-list"></ul>
    </div>
    <input type="number" name="partnerId" placeholder="Partner ID" required>
    <input type="number" name="quantity" placeholder="Quantity" required>

    <!-- Buttons for adjusting main storage -->
    <button name="adjustMainStorage" data-action="add">Add to Main Storage</button>
    <button name="adjustMainStorage" data-action="subtract">Subtract from Main Storage</button>
    
</body>
</html>

 


